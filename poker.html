<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Poker</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #1a1a2e;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden;
        }
        
        .container {
            text-align: center;
            background-color: #16213e;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
            width: 90%;
            max-width: 800px;
            position: relative;
            z-index: 1;
        }
        
        h1 {
            color: #f1c40f;
            margin-top: 0;
            text-shadow: 0 0 10px rgba(241, 196, 15, 0.5);
        }
        
        .balance {
            font-size: 1.2rem;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
        }
        
        .hand {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
            perspective: 1000px;
        }
        
        .card {
            width: 80px;
            height: 120px;
            background: white;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: black;
            font-size: 24px;
            font-weight: bold;
            position: relative;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            transform-style: preserve-3d;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .card.red {
            color: red;
        }
        
        .card.held {
            box-shadow: 0 0 20px gold;
            transform: translateY(-10px);
        }
        
        .card.dealing {
            animation: dealCard 0.5s forwards;
        }
        
        .card.flipping {
            animation: flipCard 0.6s forwards;
        }
        
        @keyframes dealCard {
            0% { transform: translateY(-100px) rotateY(180deg); opacity: 0; }
            100% { transform: translateY(0) rotateY(0); opacity: 1; }
        }
        
        @keyframes flipCard {
            0% { transform: rotateY(0); }
            50% { transform: rotateY(90deg); }
            100% { transform: rotateY(0); }
        }
        
        .card-suit {
            font-size: 16px;
            margin-top: 5px;
        }
        
        .controls {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        button {
            background-color: #f1c40f;
            color: #1a1a2e;
            border: none;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        button:hover {
            background-color: #f39c12;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        button:disabled {
            background-color: #7f8c8d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .bet-controls {
            margin: 20px 0;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        
        .bet-controls button {
            padding: 8px 15px;
            width: 40px;
        }
        
        .message {
            min-height: 30px;
            font-size: 1.2rem;
            margin: 15px 0;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .win {
            color: #2ecc71;
            text-shadow: 0 0 10px rgba(46, 204, 113, 0.5);
            animation: pulse 0.5s infinite alternate;
        }
        
        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }
        
        .payouts {
            margin-top: 30px;
            text-align: left;
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 10px;
        }
        
        .payouts h3 {
            color: #f1c40f;
            margin-top: 0;
        }
        
        .back-button {
            margin-top: 20px;
            background: #3498db;
            padding: 10px 20px;
            border-radius: 5px;
            color: white;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s;
        }
        
        .back-button:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .chip {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #f1c40f, #e67e22);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1a1a2e;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            z-index: 10;
            animation: chipFall 0.5s forwards;
        }
        
        @keyframes chipFall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 0; }
            100% { transform: translateY(0) rotate(360deg); opacity: 1; }
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
            z-index: 0;
            pointer-events: none;
        }
        
        .win-glow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(46,204,113,0.2) 0%, rgba(46,204,113,0) 70%);
            z-index: 0;
            pointer-events: none;
            animation: glowPulse 2s infinite alternate;
        }
        
        @keyframes glowPulse {
            from { opacity: 0.2; }
            to { opacity: 0.5; }
        }
        
        .jackpot-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,215,0,0.3) 0%, rgba(255,215,0,0) 70%);
            z-index: 0;
            pointer-events: none;
            animation: jackpotGlow 2s infinite alternate;
        }
        
        @keyframes jackpotGlow {
            from { opacity: 0.3; }
            to { opacity: 0.7; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>♠️ Video Poker ♣️</h1>
        
        <div class="balance">
            <div>Balance: $<span id="balance">1000</span></div>
            <div>Bet: $<span id="current-bet">10</span></div>
        </div>
        
        <div class="bet-controls">
            <button id="decrease-bet">-</button>
            <button id="increase-bet">+</button>
        </div>
        
        <div class="hand" id="hand">
            <!-- Cards will be added here -->
        </div>
        
        <div class="message" id="message"></div>
        
        <div class="controls">
            <button id="deal-button">DEAL</button>
            <button id="draw-button" disabled>DRAW</button>
        </div>
        
        <div class="payouts">
            <h3>Payouts:</h3>
            <p>Royal Flush: 250x</p>
            <p>Straight Flush: 50x</p>
            <p>Four of a Kind: 25x</p>
            <p>Full House: 9x</p>
            <p>Flush: 6x</p>
            <p>Straight: 4x</p>
            <p>Three of a Kind: 3x</p>
            <p>Two Pair: 2x</p>
            <p>Jacks or Better: 1x</p>
        </div>
        
        <a href="index.html" class="back-button">← Back to Game Hub</a>
    </div>

    <audio id="dealSound" src="https://assets.mixkit.co/sfx/preview/mixkit-card-dealing-1560.mp3" preload="auto"></audio>
    <audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" preload="auto"></audio>
    <audio id="holdSound" src="https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3" preload="auto"></audio>
    <audio id="chipSound" src="https://assets.mixkit.co/sfx/preview/mixkit-coins-handling-1939.mp3" preload="auto"></audio>
    <audio id="clickSound" src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" preload="auto"></audio>

    <script>
        // Card values and suits
        const cardValues = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        const cardSuits = ['♥', '♦', '♣', '♠'];
        
        // Payouts
        const payouts = {
            'royalFlush': 250,
            'straightFlush': 50,
            'fourOfAKind': 25,
            'fullHouse': 9,
            'flush': 6,
            'straight': 4,
            'threeOfAKind': 3,
            'twoPair': 2,
            'jacksOrBetter': 1
        };
        
        // Game state
        let balance = parseInt(localStorage.getItem('casinoBalance')) || 1000;
        let currentBet = 10;
        let deck = [];
        let hand = [];
        let heldCards = [];
        let gameStage = 'bet'; // 'bet' or 'draw'
        
        // DOM elements
        const balanceDisplay = document.getElementById('balance');
        const currentBetDisplay = document.getElementById('current-bet');
        const handElement = document.getElementById('hand');
        const messageElement = document.getElementById('message');
        const dealButton = document.getElementById('deal-button');
        const drawButton = document.getElementById('draw-button');
        const decreaseBetButton = document.getElementById('decrease-bet');
        const increaseBetButton = document.getElementById('increase-bet');
        
        // Audio elements
        const dealSound = document.getElementById('dealSound');
        const winSound = document.getElementById('winSound');
        const holdSound = document.getElementById('holdSound');
        const chipSound = document.getElementById('chipSound');
        const clickSound = document.getElementById('clickSound');
        
        // Initialize the game
        function init() {
            updateDisplay();
            
            // Event listeners
            dealButton.addEventListener('click', deal);
            drawButton.addEventListener('click', draw);
            decreaseBetButton.addEventListener('click', () => {
                playSound(clickSound);
                changeBet(-5);
            });
            increaseBetButton.addEventListener('click', () => {
                playSound(clickSound);
                changeBet(5);
            });
        }
        
        // Play sound
        function playSound(sound) {
            sound.currentTime = 0;
            sound.play().catch(e => console.log("Audio play failed:", e));
        }
        
        // Create a new shuffled deck
        function createDeck() {
            const deck = [];
            for (const suit of cardSuits) {
                for (const value of cardValues) {
                    deck.push({ value, suit });
                }
            }
            return shuffleDeck(deck);
        }
        
        // Shuffle the deck
        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }
        
        // Deal initial hand
        function deal() {
            if (gameStage !== 'bet' || balance < currentBet) return;
            
            playSound(chipSound);
            createChipAnimation();
            
            balance -= currentBet;
            gameStage = 'draw';
            deck = createDeck();
            hand = [];
            heldCards = [];
            messageElement.textContent = '';
            messageElement.className = 'message';
            
            // Deal cards with animations
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    playSound(dealSound);
                    hand.push(drawCard());
                    updateHandDisplay();
                    
                    if (i === 4) {
                        updateControls();
                    }
                }, i * 300);
            }
            
            // Update global balance
            localStorage.setItem('casinoBalance', balance.toString());
        }
        
        // Draw a card from the deck
        function drawCard() {
            return deck.pop();
        }
        
        // Draw new cards for non-held cards
        function draw() {
            if (gameStage !== 'draw') return;
            
            for (let i = 0; i < 5; i++) {
                if (!heldCards.includes(i)) {
                    setTimeout(() => {
                        playSound(dealSound);
                        hand[i] = drawCard();
                        updateHandDisplay();
                        
                        if (i === 4) {
                            evaluateHand();
                            gameStage = 'bet';
                            updateControls();
                        }
                    }, i * 200);
                }
            }
        }
        
        // Toggle hold on a card
        function toggleHold(index) {
            if (gameStage !== 'draw') return;
            
            const cardIndex = heldCards.indexOf(index);
            if (cardIndex === -1) {
                heldCards.push(index);
                playSound(holdSound);
            } else {
                heldCards.splice(cardIndex, 1);
                playSound(clickSound);
            }
            
            updateHandDisplay();
        }
        
        // Evaluate the hand and pay out
        function evaluateHand() {
            const handValue = getHandValue(hand);
            let winnings = 0;
            
            if (handValue) {
                winnings = currentBet * payouts[handValue];
                balance += winnings;
                
                if (handValue === 'royalFlush') {
                    createJackpotAnimation();
                } else if (winnings > currentBet * 5) {
                    createWinGlow();
                }
                
                if (winnings > 0) {
                    playSound(winSound);
                    createConfetti();
                }
                
                messageElement.textContent = `${formatHandName(handValue)}! You win $${winnings}!`;
                messageElement.className = 'message win';
            } else {
                messageElement.textContent = 'No winning hand';
                messageElement.className = 'message';
            }
            
            updateDisplay();
            
            // Update global balance
            localStorage.setItem('casinoBalance', balance.toString());
        }
        
        // Get the value of the hand
        function getHandValue(cards) {
            const values = cards.map(card => card.value);
            const suits = cards.map(card => card.suit);
            const valueCounts = {};
            
            // Count occurrences of each value
            values.forEach(value => {
                valueCounts[value] = (valueCounts[value] || 0) + 1;
            });
            
            // Check for flush (all same suit)
            const isFlush = suits.every(suit => suit === suits[0]);
            
            // Check for straight
            const valueOrder = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
            const sortedValues = [...new Set(values)].sort((a, b) => 
                valueOrder.indexOf(a) - valueOrder.indexOf(b));
            let isStraight = false;
            
            if (sortedValues.length === 5) {
                const firstIndex = valueOrder.indexOf(sortedValues[0]);
                isStraight = sortedValues.every((value, i) => 
                    value === valueOrder[firstIndex + i]);
            }
            
            // Check for royal straight (10-J-Q-K-A)
            const isRoyal = ['10', 'J', 'Q', 'K', 'A'].every(val => 
                values.includes(val));
            
            // Determine hand value
            if (isRoyal && isFlush) return 'royalFlush';
            if (isStraight && isFlush) return 'straightFlush';
            if (Object.values(valueCounts).includes(4)) return 'fourOfAKind';
            if (Object.values(valueCounts).includes(3) && Object.values(valueCounts).includes(2)) return 'fullHouse';
            if (isFlush) return 'flush';
            if (isStraight) return 'straight';
            if (Object.values(valueCounts).includes(3)) return 'threeOfAKind';
            if (Object.values(valueCounts).filter(count => count === 2).length === 2) return 'twoPair';
            
            // Check for jacks or better
            const highPairs = ['J', 'Q', 'K', 'A'];
            if (highPairs.some(val => valueCounts[val] === 2)) return 'jacksOrBetter';
            
            return null;
        }
        
        // Format hand name for display
        function formatHandName(handValue) {
            const names = {
                'royalFlush': 'Royal Flush',
                'straightFlush': 'Straight Flush',
                'fourOfAKind': 'Four of a Kind',
                'fullHouse': 'Full House',
                'flush': 'Flush',
                'straight': 'Straight',
                'threeOfAKind': 'Three of a Kind',
                'twoPair': 'Two Pair',
                'jacksOrBetter': 'Jacks or Better'
            };
            return names[handValue];
        }
        
        // Update hand display
        function updateHandDisplay() {
            handElement.innerHTML = '';
            
            hand.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card dealing';
                if (heldCards.includes(index)) {
                    cardElement.classList.add('held');
                }
                
                cardElement.innerHTML = `
                    <div>${card.value}</div>
                    <div class="card-suit">${card.suit}</div>
                `;
                
                if (card.suit === '♥' || card.suit === '♦') {
                    cardElement.classList.add('red');
                }
                
                cardElement.addEventListener('click', () => toggleHold(index));
                
                handElement.appendChild(cardElement);
                
                // Remove dealing class after animation completes
                setTimeout(() => {
                    cardElement.classList.remove('dealing');
                }, 500);
            });
        }
        
        // Update the display
        function updateDisplay() {
            balanceDisplay.textContent = balance;
            currentBetDisplay.textContent = currentBet;
        }
        
        // Update control buttons
        function updateControls() {
            dealButton.disabled = gameStage !== 'bet' || balance < currentBet;
            dealButton.textContent = gameStage === 'bet' ? 'DEAL' : 'DEAL AGAIN';
            drawButton.disabled = gameStage !== 'draw';
            decreaseBetButton.disabled = gameStage !== 'bet' || currentBet <= 5;
            increaseBetButton.disabled = gameStage !== 'bet' || balance < currentBet + 5;
        }
        
        // Change bet amount
        function changeBet(amount) {
            const newBet = currentBet + amount;
            if (newBet >= 5 && newBet <= balance) {
                currentBet = newBet;
                updateDisplay();
            }
        }
        
        // Create chip animation
        function createChipAnimation() {
            const chip = document.createElement('div');
            chip.className = 'chip';
            chip.textContent = currentBet;
            chip.style.left = `${Math.random() * 100}%`;
            document.body.appendChild(chip);
            
            setTimeout(() => {
                chip.remove();
            }, 1000);
        }
        
        // Create confetti effect
        function createConfetti() {
            const colors = ['#f1c40f', '#e74c3c', '#2ecc71', '#3498db', '#9b59b6'];
            
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.top = '-10px';
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                document.body.appendChild(confetti);
                
                // Animate confetti
                const animation = confetti.animate([
                    { top: '-10px', opacity: 1, transform: `rotate(${Math.random() * 360}deg)` },
                    { top: '100vh', opacity: 0, transform: `rotate(${Math.random() * 360}deg)` }
                ], {
                    duration: 2000 + Math.random() * 3000,
                    easing: 'cubic-bezier(0.1, 0.8, 0.9, 1)'
                });
                
                animation.onfinish = () => confetti.remove();
            }
        }
        
        // Create win glow effect
        function createWinGlow() {
            const glow = document.createElement('div');
            glow.className = 'win-glow';
            document.body.appendChild(glow);
            
            setTimeout(() => {
                glow.remove();
            }, 2000);
        }
        
        // Create jackpot animation
        function createJackpotAnimation() {
            const jackpot = document.createElement('div');
            jackpot.className = 'jackpot-animation';
            document.body.appendChild(jackpot);
            
            setTimeout(() => {
                jackpot.remove();
            }, 3000);
        }
        
        // Initialize the game
        init();
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blackjack</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #1a1a2e;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden;
        }
        
        .container {
            text-align: center;
            background-color: #16213e;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
            width: 90%;
            max-width: 800px;
            position: relative;
            z-index: 1;
        }
        
        h1 {
            color: #f1c40f;
            margin-top: 0;
            text-shadow: 0 0 10px rgba(241, 196, 15, 0.5);
        }
        
        .balance {
            font-size: 1.2rem;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
        }
        
        .game-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
        }
        
        .hand {
            min-height: 120px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            perspective: 1000px;
        }
        
        .card {
            width: 80px;
            height: 120px;
            background: white;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: black;
            font-size: 24px;
            font-weight: bold;
            position: relative;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            transform-style: preserve-3d;
            transition: transform 0.5s, box-shadow 0.3s;
        }
        
        .card.red {
            color: red;
        }
        
        .card.back {
            background: linear-gradient(135deg, #e74c3c, #3498db);
            color: white;
        }
        
        .card-suit {
            font-size: 16px;
            margin-top: 5px;
        }
        
        .card.dealing {
            animation: dealCard 0.5s forwards;
        }
        
        .card.flip {
            animation: flipCard 0.6s forwards;
        }
        
        @keyframes dealCard {
            0% { transform: translateY(-100px) rotateY(180deg); opacity: 0; }
            100% { transform: translateY(0) rotateY(0); opacity: 1; }
        }
        
        @keyframes flipCard {
            0% { transform: rotateY(0); }
            50% { transform: rotateY(90deg); }
            100% { transform: rotateY(0); }
        }
        
        .controls {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        button {
            background-color: #f1c40f;
            color: #1a1a2e;
            border: none;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        button:hover {
            background-color: #f39c12;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        button:disabled {
            background-color: #7f8c8d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .bet-controls {
            margin: 20px 0;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        
        .bet-controls button {
            padding: 8px 15px;
            width: 40px;
        }
        
        .message {
            min-height: 30px;
            font-size: 1.2rem;
            margin: 15px 0;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .win {
            color: #2ecc71;
            text-shadow: 0 0 10px rgba(46, 204, 113, 0.5);
            animation: pulse 0.5s infinite alternate;
        }
        
        .lose {
            color: #e74c3c;
        }
        
        .blackjack {
            color: #f1c40f;
            text-shadow: 0 0 10px rgba(241, 196, 15, 0.5);
            animation: pulse 0.5s infinite alternate;
        }
        
        @keyframes pulse {
            from { transform: scale(1); }
            to { transform: scale(1.05); }
        }
        
        .back-button {
            margin-top: 20px;
            background: #3498db;
            padding: 10px 20px;
            border-radius: 5px;
            color: white;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s;
        }
        
        .back-button:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .chip {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #f1c40f, #e67e22);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1a1a2e;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            z-index: 10;
            animation: chipFall 0.5s forwards;
        }
        
        @keyframes chipFall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 0; }
            100% { transform: translateY(0) rotate(360deg); opacity: 1; }
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
            z-index: 0;
            pointer-events: none;
        }
        
        .win-glow {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(46,204,113,0.2) 0%, rgba(46,204,113,0) 70%);
            z-index: 0;
            pointer-events: none;
            animation: glowPulse 2s infinite alternate;
        }
        
        @keyframes glowPulse {
            from { opacity: 0.2; }
            to { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üÉè Blackjack</h1>
        
        <div class="balance">
            <div>Balance: $<span id="balance">1000</span></div>
            <div>Bet: $<span id="current-bet">10</span></div>
        </div>
        
        <div class="bet-controls">
            <button id="decrease-bet">-</button>
            <button id="increase-bet">+</button>
        </div>
        
        <div class="game-area">
            <div>
                <h3>Dealer's Hand (<span id="dealer-score">?</span>)</h3>
                <div class="hand" id="dealer-hand"></div>
            </div>
            
            <div>
                <h3>Your Hand (<span id="player-score">0</span>)</h3>
                <div class="hand" id="player-hand"></div>
            </div>
        </div>
        
        <div class="message" id="message"></div>
        
        <div class="controls">
            <button id="deal-button">DEAL</button>
            <button id="hit-button" disabled>HIT</button>
            <button id="stand-button" disabled>STAND</button>
        </div>
        
        <a href="index.html" class="back-button">‚Üê Back to Game Hub</a>
    </div>

    <audio id="dealSound" src="https://assets.mixkit.co/sfx/preview/mixkit-card-dealing-1560.mp3" preload="auto"></audio>
    <audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" preload="auto"></audio>
    <audio id="loseSound" src="https://assets.mixkit.co/sfx/preview/mixkit-retro-arcade-lose-2027.mp3" preload="auto"></audio>
    <audio id="chipSound" src="https://assets.mixkit.co/sfx/preview/mixkit-coins-handling-1939.mp3" preload="auto"></audio>
    <audio id="clickSound" src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" preload="auto"></audio>

    <script>
        // Card values and suits
        const cardValues = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        const cardSuits = ['‚ô•', '‚ô¶', '‚ô£', '‚ô†'];
        
        // Game state
        let balance = parseInt(localStorage.getItem('casinoBalance')) || 1000;
        let currentBet = 10;
        let deck = [];
        let dealerHand = [];
        let playerHand = [];
        let gameInProgress = false;
        
        // DOM elements
        const balanceDisplay = document.getElementById('balance');
        const currentBetDisplay = document.getElementById('current-bet');
        const dealerHandElement = document.getElementById('dealer-hand');
        const playerHandElement = document.getElementById('player-hand');
        const dealerScoreElement = document.getElementById('dealer-score');
        const playerScoreElement = document.getElementById('player-score');
        const messageElement = document.getElementById('message');
        const dealButton = document.getElementById('deal-button');
        const hitButton = document.getElementById('hit-button');
        const standButton = document.getElementById('stand-button');
        const decreaseBetButton = document.getElementById('decrease-bet');
        const increaseBetButton = document.getElementById('increase-bet');
        
        // Audio elements
        const dealSound = document.getElementById('dealSound');
        const winSound = document.getElementById('winSound');
        const loseSound = document.getElementById('loseSound');
        const chipSound = document.getElementById('chipSound');
        const clickSound = document.getElementById('clickSound');
        
        // Initialize the game
        function init() {
            updateDisplay();
            
            // Event listeners
            dealButton.addEventListener('click', startGame);
            hitButton.addEventListener('click', hit);
            standButton.addEventListener('click', stand);
            decreaseBetButton.addEventListener('click', () => {
                playSound(clickSound);
                changeBet(-5);
            });
            increaseBetButton.addEventListener('click', () => {
                playSound(clickSound);
                changeBet(5);
            });
        }
        
        // Play sound
        function playSound(sound) {
            sound.currentTime = 0;
            sound.play().catch(e => console.log("Audio play failed:", e));
        }
        
        // Create a new shuffled deck
        function createDeck() {
            const deck = [];
            for (const suit of cardSuits) {
                for (const value of cardValues) {
                    deck.push({ value, suit });
                }
            }
            return shuffleDeck(deck);
        }
        
        // Shuffle the deck
        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }
        
        // Start a new game
        function startGame() {
            if (gameInProgress || balance < currentBet) return;
            
            playSound(chipSound);
            createChipAnimation();
            
            balance -= currentBet;
            gameInProgress = true;
            deck = createDeck();
            dealerHand = [];
            playerHand = [];
            messageElement.textContent = '';
            messageElement.className = 'message';
            
            // Initial deal with animations
            setTimeout(() => {
                playSound(dealSound);
                dealerHand.push(drawCard(true));
                updateHandDisplay(dealerHand, dealerHandElement, true);
                
                setTimeout(() => {
                    playSound(dealSound);
                    playerHand.push(drawCard(false));
                    updateHandDisplay(playerHand, playerHandElement, false);
                    
                    setTimeout(() => {
                        playSound(dealSound);
                        dealerHand.push(drawCard(true));
                        updateHandDisplay(dealerHand, dealerHandElement, true);
                        
                        setTimeout(() => {
                            playSound(dealSound);
                            playerHand.push(drawCard(false));
                            updateHandDisplay(playerHand, playerHandElement, false);
                            
                            updateDisplay();
                            updateControls();
                            checkBlackjack();
                            
                            // Update global balance
                            localStorage.setItem('casinoBalance', balance.toString());
                        }, 300);
                    }, 300);
                }, 300);
            }, 300);
        }
        
        // Draw a card from the deck with animation
        function drawCard(isDealer) {
            const card = deck.pop();
            return card;
        }
        
        // Player draws a card
        function hit() {
            if (!gameInProgress) return;
            
            playSound(dealSound);
            playerHand.push(drawCard(false));
            updateHandDisplay(playerHand, playerHandElement, false);
            
            const playerScore = calculateScore(playerHand);
            playerScoreElement.textContent = playerScore;
            
            if (playerScore > 21) {
                playSound(loseSound);
                endGame('BUST! You lose.', 'lose');
            } else {
                updateDisplay();
            }
        }
        
        // Player stands
        function stand() {
            if (!gameInProgress) return;
            
            // Reveal dealer's hidden card with flip animation
            const hiddenCard = dealerHandElement.children[0];
            hiddenCard.classList.add('flip');
            playSound(dealSound);
            
            setTimeout(() => {
                dealerScoreElement.textContent = calculateScore(dealerHand);
                
                // Dealer draws until score >= 17
                const dealerDraw = () => {
                    if (calculateScore(dealerHand) < 17) {
                        setTimeout(() => {
                            playSound(dealSound);
                            dealerHand.push(drawCard(false));
                            updateHandDisplay(dealerHand, dealerHandElement, false);
                            dealerScoreElement.textContent = calculateScore(dealerHand);
                            dealerDraw();
                        }, 500);
                    } else {
                        determineWinner();
                    }
                };
                
                dealerDraw();
            }, 300);
        }
        
        // Determine the winner
        function determineWinner() {
            const dealerScore = calculateScore(dealerHand);
            const playerScore = calculateScore(playerHand);
            
            if (dealerScore > 21) {
                const winnings = currentBet * 2;
                balance += winnings;
                playSound(winSound);
                createConfetti();
                endGame(`Dealer busts! You win $${winnings}!`, 'win');
            } else if (playerScore > dealerScore) {
                const winnings = currentBet * 2;
                balance += winnings;
                playSound(winSound);
                createConfetti();
                endGame(`You win $${winnings}!`, 'win');
            } else if (playerScore === dealerScore) {
                balance += currentBet;
                endGame('Push! Bet returned', '');
            } else {
                playSound(loseSound);
                endGame('Dealer wins!', 'lose');
            }
            
            // Update global balance
            localStorage.setItem('casinoBalance', balance.toString());
        }
        
        // Calculate hand score
        function calculateScore(hand) {
            let score = 0;
            let aces = 0;
            
            for (const card of hand) {
                if (card.value === 'A') {
                    score += 11;
                    aces++;
                } else if (['K', 'Q', 'J'].includes(card.value)) {
                    score += 10;
                } else {
                    score += parseInt(card.value);
                }
            }
            
            while (score > 21 && aces > 0) {
                score -= 10;
                aces--;
            }
            
            return score;
        }
        
        // Check for blackjack
        function checkBlackjack() {
            const playerScore = calculateScore(playerHand);
            const dealerScore = calculateScore(dealerHand);
            
            if (playerScore === 21) {
                if (dealerScore === 21) {
                    balance += currentBet;
                    endGame('Both have blackjack! Push!', '');
                } else {
                    const winnings = Math.floor(currentBet * 2.5);
                    balance += winnings;
                    playSound(winSound);
                    createConfetti();
                    endGame(`BLACKJACK! You win $${winnings}!`, 'blackjack');
                }
                
                // Update global balance
                localStorage.setItem('casinoBalance', balance.toString());
            }
        }
        
        // End the game
        function endGame(message, resultClass) {
            gameInProgress = false;
            messageElement.textContent = message;
            messageElement.className = 'message ' + resultClass;
            
            // Reveal dealer's cards
            dealerScoreElement.textContent = calculateScore(dealerHand);
            updateHandDisplay(dealerHand, dealerHandElement, false);
            
            updateControls();
        }
        
        // Update the display
        function updateDisplay() {
            balanceDisplay.textContent = balance;
            currentBetDisplay.textContent = currentBet;
            
            // Update scores
            playerScoreElement.textContent = calculateScore(playerHand);
            dealerScoreElement.textContent = gameInProgress ? '?' : calculateScore(dealerHand);
        }
        
        // Update hand display
        function updateHandDisplay(hand, element, hideFirstCard) {
            element.innerHTML = '';
            
            hand.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card dealing';
                
                if (index === 0 && hideFirstCard) {
                    cardElement.textContent = 'üÇ†';
                    cardElement.className = 'card back dealing';
                } else {
                    cardElement.innerHTML = `
                        <div>${card.value}</div>
                        <div class="card-suit">${card.suit}</div>
                    `;
                    
                    if (card.suit === '‚ô•' || card.suit === '‚ô¶') {
                        cardElement.classList.add('red');
                    }
                }
                
                element.appendChild(cardElement);
                
                // Remove dealing class after animation completes
                setTimeout(() => {
                    cardElement.classList.remove('dealing');
                }, 500);
            });
        }
        
        // Update control buttons
        function updateControls() {
            dealButton.disabled = gameInProgress || balance < currentBet;
            hitButton.disabled = !gameInProgress;
            standButton.disabled = !gameInProgress;
            decreaseBetButton.disabled = gameInProgress || currentBet <= 5;
            increaseBetButton.disabled = gameInProgress || balance < currentBet + 5;
        }
        
        // Change bet amount
        function changeBet(amount) {
            const newBet = currentBet + amount;
            if (newBet >= 5 && newBet <= balance) {
                currentBet = newBet;
                updateDisplay();
            }
        }
        
        // Create chip animation
        function createChipAnimation() {
            const chip = document.createElement('div');
            chip.className = 'chip';
            chip.textContent = currentBet;
            chip.style.left = `${Math.random() * 100}%`;
            document.body.appendChild(chip);
            
            setTimeout(() => {
                chip.remove();
            }, 1000);
        }
        
        // Create confetti effect
        function createConfetti() {
            const colors = ['#f1c40f', '#e74c3c', '#2ecc71', '#3498db', '#9b59b6'];
            
            // Create win glow
            const glow = document.createElement('div');
            glow.className = 'win-glow';
            document.body.appendChild(glow);
            
            setTimeout(() => {
                glow.remove();
            }, 2000);
            
            // Create confetti
            for (let i = 0; i < 100; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.top = '-10px';
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                document.body.appendChild(confetti);
                
                // Animate confetti
                const animation = confetti.animate([
                    { top: '-10px', opacity: 1, transform: `rotate(${Math.random() * 360}deg)` },
                    { top: '100vh', opacity: 0, transform: `rotate(${Math.random() * 360}deg)` }
                ], {
                    duration: 2000 + Math.random() * 3000,
                    easing: 'cubic-bezier(0.1, 0.8, 0.9, 1)'
                });
                
                animation.onfinish = () => confetti.remove();
            }
        }
        
        // Initialize the game
        init();
    </script>
</body>
</html>